version: '3.7'

#---------------------------------------------------------------------------
x-base: &base
  logging:
    driver: "json-file"
    options:
      max-size: "3m"
      max-file: "1"
  # https://docs.docker.com/compose/compose-file/#restart
  restart: ${DOCKER_RESTART:-unless-stopped}

#---------------------------------------------------------------------------
services:
  mosquitto:
    <<: *base
    image: eclipse-mosquitto:1.6.8
  
  simulator:
    <<: *base
    build:
      context: ./simulator
    depends_on: ['mosquitto']
